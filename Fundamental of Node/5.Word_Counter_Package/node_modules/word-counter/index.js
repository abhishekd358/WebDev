#!/usr/bin/env node

import {readFile} from 'node:fs/promises'

// here we take the user pass file path through process argv
const filePath = process.argv[2]
// console.log(filePath)

// check user should pass the file in CLI 
if(!filePath){
    console.log("Please provide a file path");
    console.log("ðŸ‘‰ Usage: word-counter <file-path>\n");
    process.exit(1)
}

// reading user inputed file
let fileContent;
try {
   fileContent = await readFile(filePath, "utf-8")
} catch (error) {
    console.error(`âŒ Error reading file: ${err.message}`)
    process.exit(1)
    
}

// spliting the content based or non-word character with regex
const arrOfWords = fileContent.split(/[\W]/)
// console.log(arrOfWords);

// now we create a empty object that we return to user to show ki words and unke count
let wordCounter = {}

arrOfWords.forEach((w)=>{
    const word = w.toLowerCase()
    // if object mai hai to +1 se key ke value ko badhao 
    if(Object.keys(wordCounter).includes(word)){
        wordCounter[word] = wordCounter[word] + 1
    }else{
        // other else we add new word and its value as 1
        wordCounter[word] = 1
    }
})



// -------------------------- total words and unique word we show
console.log("-----------------------------------");
let totalWords = 0
let totalUniqueWords = 0
for(const [word, count] of Object.entries(wordCounter)){
    console.log(`${word.padEnd(15)} : ${count}`);
    totalWords += count
    totalUniqueWords+=1
    
}



console.log("-----------------------------------");
console.log(`ðŸ§® Total Words: ${totalWords}`);
console.log(`ðŸ”  Unique Words: ${totalUniqueWords}`);
console.log("\nâœ… Word count completed successfully!\n")
